use std::io::Cursor;

use gromnie::net::packets::login_request::LoginRequestPacket;

#[test]
fn test_message_login_request() {
    // Login with root:root, captured with aclog
    let pak_data_root_root = vec![
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xf3,
        0x76, 0x27, 0xac, 0x00, 0x00, 0x00, 0x00, 0x2d, 0x00,
        0x00, 0x00, 0x04, 0x00, 0x31, 0x38, 0x30, 0x32, 0x00,
        0x00, 0x21, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x16, 0xed, 0xf4, 0x65, 0x04,
        0x00, 0x72, 0x6f, 0x6f, 0x74, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x04, 0x72, 0x6f,
        0x6f, 0x74];

    let mut pak_root_root = LoginRequestPacket::new("root", "root");
    let mut buffer_root_root = Cursor::new(Vec::new());
    pak_root_root.serialize(&mut buffer_root_root);
    assert_eq!(pak_data_root_root, buffer_root_root.into_inner());

    // Login with testing:testing, captured with aclog
    let pak_data_testing_testing = vec![
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xf6,
        0xe2, 0xfd, 0x07, 0x00, 0x00, 0x00, 0x00, 0x34, 0x00,
        0x00, 0x00, 0x04, 0x00, 0x31, 0x38, 0x30, 0x32, 0x00,
        0x00, 0x28, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x23, 0xed, 0xf4, 0x65, 0x07,
        0x00, 0x74, 0x65, 0x73, 0x74, 0x69, 0x6e, 0x67, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00,
        0x00, 0x07, 0x74, 0x65, 0x73, 0x74, 0x69, 0x6e, 0x67];

    let mut pak_testing_testing = LoginRequestPacket::new("testing", "testing");
    let mut buffer_testing_testing = Cursor::new(Vec::new());
    pak_testing_testing.serialize(&mut buffer_testing_testing);
    assert_eq!(pak_data_testing_testing, buffer_testing_testing.into_inner());

    // Logging in with elevencharsl:elevencharsl, captured with aclog
    let pak_data_elevencharsl_elevencharsl = vec![
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xee,
        0x07, 0xcf, 0x4e, 0x00, 0x00, 0x00, 0x00, 0x3d, 0x00,
        0x00, 0x00, 0x04, 0x00, 0x31, 0x38, 0x30, 0x32, 0x00,
        0x00, 0x31, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x2f, 0xed, 0xf4, 0x65, 0x0c,
        0x00, 0x65, 0x6c, 0x65, 0x76, 0x65, 0x6e, 0x63, 0x68,
        0x61, 0x72, 0x73, 0x6c, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x0d, 0x00, 0x00, 0x00, 0x0c, 0x65, 0x6c, 0x65,
        0x76, 0x65, 0x6e, 0x63, 0x68, 0x61, 0x72, 0x73, 0x6c];

    let mut pak_elevencharsl_elevencharsl = LoginRequestPacket::new("elevencharsl", "elevencharsl");
    let mut buffer_elevencharsl_elevencharsl = Cursor::new(Vec::new());
    pak_elevencharsl_elevencharsl.serialize(&mut buffer_elevencharsl_elevencharsl);
    assert_eq!(pak_data_elevencharsl_elevencharsl, buffer_elevencharsl_elevencharsl.into_inner());
}
